––– block: ../base/init –––
––– input –––
docker network create app-network --driver bridge > /dev/null; echo $?
––– output –––
0
––– input –––
docker run -d --name postgres --network app-network -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=qazQASD! -e POSTGRES_DB=api_db -p 5432:5432 -v $(pwd)/docker/clt_tests/tests/postgres-docker/init.sql:/docker-entrypoint-initdb.d/init.sql postgres:latest
––– output –––
––– input –––
docker run -d --name manticore --network app-network --restart always --ulimit nproc=65535 --ulimit nofile=65535:65535 --ulimit memlock=-1:-1 -e EXTRA=1 -e CREATE_PLAIN_TABLES=1 -p 127.0.0.1:9306:9306 -p 127.0.0.1:9308:9308 -v $(pwd)/docker/clt_tests/tests/postgres-docker/manticore.conf:/etc/manticoresearch/manticore.conf manticoresoftware/manticore:current
––– output –––
––– input –––
if timeout 5 grep -qm2 'accepting connections' <(docker logs -f manticore); then echo 'accepting connections'; else echo 'Manticore failed to start properly in 10 seconds'; fi
––– output –––
accepting connections
––– input –––
docker exec manticore mysql -e "SHOW TABLES\G;"
––– output –––
––– input –––
docker exec manticore mysql -e "SELECT * FROM text_idx\G;"
––– output –––
